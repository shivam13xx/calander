<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Floral Calendar 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Fonts: Sacramento (Script), Cormorant Garamond (Serif), Shadows Into Light (Handwritten) -->
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600&family=Sacramento&family=Shadows+Into+Light&display=swap" rel="stylesheet">
    
    <!-- Babel for in-browser JSX/TS compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.32.0",
    "react-dom/client": "https://aistudiocdn.com/react-dom@^19.2.1/client",
    "react-dom": "https://aistudiocdn.com/react-dom@^19.2.1/",
    "react": "https://aistudiocdn.com/react@^19.2.1/",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.1/",
    "react/": "https://aistudiocdn.com/react@^19.2.1/"
  }
}
</script>
    <style>
      /* Custom scrollbar for modal */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #fafaf9; 
      }
      ::-webkit-scrollbar-thumb {
        background: #d6d3d1; 
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #a8a29e; 
      }
      @keyframes fade-in {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-fade-in {
        animation: fade-in 0.4s ease-out forwards;
      }
    </style>
  </head>
  <body class="bg-stone-50 text-stone-800">
    <div id="root"></div>

    <script type="text/babel" data-presets="react,typescript" data-type="module">
      import React, { useState, useEffect, useCallback } from 'react';
      import ReactDOM from 'react-dom/client';
      import { GoogleGenAI } from "@google/genai";

      // ==========================================
      // CONSTANTS
      // ==========================================
      const DAYS_OF_WEEK = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

      const MONTH_NAMES = [
        'January', 'February', 'March', 'April', 'May', 'June',
        'July', 'August', 'September', 'October', 'November', 'December'
      ];

      const FLOWER_PROMPTS = [
        'Carnation', // Jan
        'Violet',    // Feb
        'Daffodil',  // Mar
        'Daisy',     // Apr
        'Lily of the Valley', // May
        'Rose',      // Jun
        'Larkspur',  // Jul
        'Gladiolus', // Aug
        'Aster',     // Sep
        'Marigold',  // Oct
        'Chrysanthemum', // Nov
        'Narcissus'  // Dec
      ];

      // Curated "Aesthetic" and "Vintage Botanical" style images
      // Using high-quality Unsplash images to ensure reliability and aesthetics
      const STATIC_FLOWER_IMAGES = [
        'https://images.unsplash.com/photo-1579290074665-276cb682b683?q=80&w=600&auto=format&fit=crop', // Jan - Aesthetic Pink
        'https://images.unsplash.com/photo-1525310072745-f49212b5ac6d?q=80&w=600&auto=format&fit=crop', // Feb - Violet/Purple
        'https://images.unsplash.com/photo-1518049195790-281b3127885b?q=80&w=600&auto=format&fit=crop', // Mar - Daffodil/Yellow
        'https://images.unsplash.com/photo-1606041008023-472dfb5e530f?q=80&w=600&auto=format&fit=crop', // Apr - Daisy
        'https://images.unsplash.com/photo-1588607142436-1c7ee21015f6?q=80&w=600&auto=format&fit=crop', // May - Lily of the Valley
        'https://images.unsplash.com/photo-1496857239036-1fb137683000?q=80&w=600&auto=format&fit=crop', // Jun - Rose
        'https://images.unsplash.com/photo-1598428864704-58569528d264?q=80&w=600&auto=format&fit=crop', // Jul - Larkspur
        'https://images.unsplash.com/photo-1589254316983-05b1872dfd30?q=80&w=600&auto=format&fit=crop', // Aug - Gladiolus
        'https://images.unsplash.com/photo-1601362840469-51e4d8d58785?q=80&w=600&auto=format&fit=crop', // Sep - Aster
        'https://images.unsplash.com/photo-1570530867803-3d0277207604?q=80&w=600&auto=format&fit=crop', // Oct - Marigold
        'https://images.unsplash.com/photo-1634568343714-c136365449bd?q=80&w=600&auto=format&fit=crop', // Nov - Chrysanthemum
        'https://images.unsplash.com/photo-1512413914633-b5043f4041ea?q=80&w=600&auto=format&fit=crop'  // Dec - Narcissus
      ];

      // Map of MM-DD to event details
      const HISTORICAL_EVENTS = {
        '12-06': {
          title: 'Mahaparinirvan Diwas',
          description: 'On this day, Dr. B.R. Ambedkar breathed his last at his home in Delhi. Millions of followers gathered to pay their respects to the architect of the Indian Constitution and the revivalist of Buddhism in India.',
          originalDate: 'December 6, 1956'
        },
        '04-14': {
          title: 'Janma Jayanti (Birth)',
          description: 'Bhimrao Ramji Ambedkar was born in the military cantonment of Mhow (now Dr. Ambedkar Nagar). He was the 14th and last child of Ramji Maloji Sakpal and Bhimabai.',
          originalDate: 'April 14, 1891'
        },
        '03-20': {
          title: 'Mahad Satyagraha',
          description: 'Dr. Ambedkar led the Mahad Satyagraha to assert the rights of Dalits to use water from the Chavadar Tale (public tank). This was a turning point in the Dalit movement for human rights.',
          originalDate: 'March 20, 1927'
        },
        '10-14': {
          title: 'Dhamma Chakra Pravartan',
          description: 'In a massive ceremony at Deekshabhoomi, Nagpur, Dr. Ambedkar along with 600,000 followers embraced Buddhism, marking the revival of the Dhamma in India.',
          originalDate: 'October 14, 1956'
        },
        '11-26': {
          title: 'Constitution Day',
          description: "The Constituent Assembly of India adopted the Constitution of India, drafted by the committee chaired by Dr. Ambedkar. He is often called the 'Father of the Indian Constitution'.",
          originalDate: 'November 26, 1949'
        }
      };

      // ==========================================
      // SERVICES
      // ==========================================
      
      // Safe environment variable access for browser
      const getApiKey = () => {
        if (typeof process !== 'undefined' && process.env && process.env.API_KEY) {
          return process.env.API_KEY;
        }
        return '';
      };
      
      const apiKey = getApiKey();
      const ai = new GoogleGenAI({ apiKey });

      const generateDateIllustration = async (context, isHistorical) => {
        if (!apiKey) return null;

        try {
          let prompt;
          if (isHistorical) {
            prompt = `
              Create an artistic, aesthetic digital illustration representing this historical context: "${context}".
              Style: Soft, elegant, watercolor or ink wash style. Not too realistic, more artistic and evocative to fit a minimalist calendar.
              Colors: Muted, vintage, or soft tones.
              Aspect Ratio: Square.
              No text in the image.
            `;
          } else {
            prompt = `
              Create a serene, peaceful, and calming abstract digital art piece.
              Context: ${context}.
              Theme: Peace, tranquility, mindfulness.
              Style: Soft pastel colors, watercolor texture, dreamy, minimalist, ethereal.
              Content: Nature elements like clouds, water ripples, flowers, or soft gradients. 
              Aspect Ratio: Square.
              No text.
            `;
          }

          const response = await ai.models.generateContent({
            model: 'gemini-2.5-flash-image',
            contents: { parts: [{ text: prompt }] }
          });

          const candidates = response.candidates;
          if (candidates && candidates.length > 0) {
            const parts = candidates[0].content.parts;
            for (const part of parts) {
              if (part.inlineData && part.inlineData.data) {
                return `data:${part.inlineData.mimeType};base64,${part.inlineData.data}`;
              }
            }
          }
          return null;
        } catch (error) {
          console.error("Error generating date illustration:", error);
          return null;
        }
      };

      const generatePeaceQuote = async () => {
        if (!apiKey) return null;

        try {
          const response = await ai.models.generateContent({
            model: 'gemini-2.5-flash',
            contents: 'Generate a short, soothing, original affirmation or quote about finding peace and calmness in the present moment. Max 20 words. No quotation marks.',
          });
          return response.text;
        } catch (error) {
          console.error("Error generating quote:", error);
          return null;
        }
      };

      // ==========================================
      // COMPONENTS
      // ==========================================

      // --- Calendar Component ---
      const Calendar = ({ 
        monthName, 
        year, 
        days, 
        imageUrl, 
        onNext, 
        onPrev,
        onDateClick
      }) => {

        const monthIndex = MONTH_NAMES.indexOf(monthName);
        const flowerName = FLOWER_PROMPTS[monthIndex];
        const [imgError, setImgError] = useState(false);

        useEffect(() => {
          setImgError(false);
        }, [imageUrl]);
        
        const getEvent = (day) => {
          const key = `${(monthIndex + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
          return HISTORICAL_EVENTS[key];
        };
        
        return (
          <div className="flex flex-col items-center w-full max-w-lg mx-auto p-8 bg-white min-h-[800px] shadow-2xl rounded-sm print:shadow-none print:w-full transition-all duration-500">
            
            {/* Artwork Section */}
            <div className="relative w-full h-64 flex justify-center items-center mb-4">
              {/* The Blob Background */}
              <div 
                className="absolute w-48 h-48 bg-stone-100 rounded-full opacity-60 z-0 border border-stone-200"
                style={{
                  borderRadius: '60% 40% 30% 70% / 60% 30% 70% 40%',
                  transform: 'rotate(-5deg) translateY(5px)'
                }}
              />
              
              {/* Static Image with Filters */}
              <div className="relative z-10 w-48 h-48 flex justify-center items-center overflow-hidden rounded-full border-4 border-white shadow-lg bg-stone-50">
                {imageUrl && !imgError ? (
                  <img 
                    src={imageUrl} 
                    alt={`${flowerName} art`} 
                    onError={() => setImgError(true)}
                    className="w-full h-full object-cover filter contrast-[0.9] sepia-[0.3] brightness-[1.05] saturate-[0.8]" 
                  />
                ) : (
                  <div className="flex flex-col items-center justify-center w-full h-full bg-stone-100 text-stone-400 p-4 text-center">
                    <span className="text-2xl mb-2 opacity-50">‚ùÄ</span>
                    <span className="text-sm font-serif italic text-stone-500">{flowerName}</span>
                  </div>
                )}
              </div>
              
              {/* Aesthetic Overlay Ring */}
              <div 
                className="absolute z-20 w-[12.5rem] h-[12.5rem] rounded-full border border-stone-300 opacity-30 pointer-events-none"
              />
            </div>

            {/* Header Section */}
            <div className="text-center mb-10 w-full relative group">
              
              {/* Nav Buttons */}
              <button 
                onClick={onPrev}
                className="absolute left-0 top-1/2 -translate-y-1/2 p-2 text-stone-300 hover:text-stone-500 transition-colors print:hidden"
                aria-label="Previous Month"
              >
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-8 h-8">
                  <path strokeLinecap="round" strokeLinejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
                </svg>
              </button>

              <button 
                onClick={onNext}
                className="absolute right-0 top-1/2 -translate-y-1/2 p-2 text-stone-300 hover:text-stone-500 transition-colors print:hidden"
                aria-label="Next Month"
              >
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-8 h-8">
                  <path strokeLinecap="round" strokeLinejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
                </svg>
              </button>

              <h1 className="text-7xl mb-1 text-stone-800" style={{ fontFamily: '"Sacramento", cursive' }}>
                {monthName}
              </h1>
              <h2 className="text-3xl text-stone-500 tracking-[0.2em] font-light" style={{ fontFamily: '"Cormorant Garamond", serif' }}>
                {year}
              </h2>
            </div>

            {/* Grid Section */}
            <div className="w-full">
              {/* Days of Week */}
              <div className="grid grid-cols-7 mb-6 border-b border-stone-100 pb-2">
                {DAYS_OF_WEEK.map((day) => (
                  <div 
                    key={day} 
                    className="text-center text-sm uppercase tracking-widest text-stone-400 font-sans"
                  >
                    {day}
                  </div>
                ))}
              </div>

              {/* Calendar Dates */}
              <div className="grid grid-cols-7 gap-y-4 gap-x-1">
                {days.map((dayData, index) => {
                  if (!dayData) {
                    return <div key={`empty-${index}`} />;
                  }
                  
                  const event = getEvent(dayData.date);

                  return (
                    <button 
                      key={dayData.date} 
                      onClick={() => onDateClick(dayData.date)}
                      className={`
                        flex flex-col items-center justify-start min-h-[3.5rem]
                        relative text-stone-600 
                        hover:text-stone-900 transition-all duration-300 
                        cursor-pointer focus:outline-none group
                        ${event ? 'text-blue-900' : ''}
                      `}
                      aria-label={`View details for ${monthName} ${dayData.date}`}
                    >
                      <span 
                        className={`
                          text-xl leading-none font-light relative z-10
                          ${event ? 'font-medium' : ''}
                          group-hover:scale-110 transition-transform
                        `} 
                        style={{ fontFamily: '"Cormorant Garamond", serif' }}
                      >
                        {dayData.date}
                      </span>
                      
                      {event ? (
                        <span className="mt-1 w-1 h-1 rounded-full bg-blue-800 opacity-60"></span>
                      ) : (
                        <span className="mt-1 w-1 h-1 rounded-full bg-stone-300 opacity-0 group-hover:opacity-100 transition-opacity"></span>
                      )}

                      {event && (
                        <span 
                          className="mt-1 text-[0.5rem] leading-none text-blue-800/70 font-sans uppercase tracking-wide text-center w-full px-0.5"
                        >
                          {event.title.split(' ')[0]}
                        </span>
                      )}
                    </button>
                  );
                })}
              </div>
            </div>
            
            {/* Print Footer */}
            <div className="hidden print:block fixed bottom-4 w-full text-center text-xs text-stone-300 font-sans tracking-widest uppercase">
              2026 Floral Calendar
            </div>
          </div>
        );
      };

      // --- DateDetailsModal Component ---
      const DateDetailsModal = ({
        isOpen,
        onClose,
        date,
        content,
        historicalEvent,
        loadingState
      }) => {
        if (!isOpen) return null;

        const formattedDate = date.toLocaleDateString('en-US', {
          weekday: 'long',
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        });

        return (
          <div className="fixed inset-0 z-50 flex items-center justify-center p-4">
            {/* Backdrop */}
            <div 
              className="absolute inset-0 bg-stone-900/40 backdrop-blur-sm transition-opacity"
              onClick={onClose}
            />

            {/* Modal Content */}
            <div className="relative bg-white w-full max-w-lg p-8 rounded-sm shadow-2xl animate-fade-in flex flex-col items-center max-h-[90vh] overflow-y-auto">
              <button 
                onClick={onClose}
                className="absolute top-4 right-4 text-gray-400 hover:text-gray-800 transition-colors z-10"
              >
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className="w-6 h-6">
                  <path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>

              <h2 className="text-4xl mb-2 text-center" style={{ fontFamily: '"Sacramento", cursive' }}>
                {formattedDate}
              </h2>
              
              {/* Historical Event Section */}
              {historicalEvent && (
                <div className="mb-6 w-full text-center border-b border-stone-200 pb-4">
                  <h3 className="text-2xl text-blue-900 mb-1 font-semibold" style={{ fontFamily: '"Cormorant Garamond", serif' }}>
                    {historicalEvent.title}
                  </h3>
                  <div className="text-xs text-stone-500 font-sans mb-3 tracking-widest uppercase">
                    {historicalEvent.originalDate}
                  </div>
                  <p className="text-stone-600 leading-relaxed font-sans text-sm">
                    {historicalEvent.description}
                  </p>
                </div>
              )}

              <div className="w-full aspect-square bg-stone-50 mb-6 flex items-center justify-center rounded-sm overflow-hidden border border-stone-100">
                {loadingState === 'LOADING' ? (
                  <div className="flex flex-col items-center gap-3">
                    <div className="w-8 h-8 border-2 border-stone-300 border-t-stone-600 rounded-full animate-spin"></div>
                    <span className="text-stone-400 font-serif italic">Finding peace...</span>
                  </div>
                ) : content?.image ? (
                  <img 
                    src={content.image} 
                    alt="Peace and calmness" 
                    className="w-full h-full object-cover animate-fade-in"
                  />
                ) : (
                  <span className="text-stone-300 font-serif italic">No image available</span>
                )}
              </div>

              <div className="text-center min-h-[4rem] flex items-center justify-center">
                 {loadingState === 'LOADING' ? (
                   <span className="h-2 w-24 bg-stone-100 rounded animate-pulse"></span>
                 ) : content?.quote ? (
                   <p className="text-xl text-stone-700 leading-relaxed font-light italic" style={{ fontFamily: '"Cormorant Garamond", serif' }}>
                     "{content.quote}"
                   </p>
                 ) : null}
              </div>
            </div>
          </div>
        );
      };

      // ==========================================
      // MAIN APP
      // ==========================================
      const App = () => {
        // Start at January 2026
        const [currentDate, setCurrentDate] = useState(new Date(2026, 0, 1));
        
        // Modal State
        const [selectedDay, setSelectedDay] = useState(null);
        const [modalContent, setModalContent] = useState(null);
        const [modalHistoricalEvent, setModalHistoricalEvent] = useState(null);
        const [modalLoading, setModalLoading] = useState('IDLE');
        
        // Cache to store generated daily content
        const [dailyCache, setDailyCache] = useState({});

        const year = currentDate.getFullYear();
        const monthIndex = currentDate.getMonth();
        const monthName = MONTH_NAMES[monthIndex];
        
        // Use static image for the current month
        const currentMonthImage = STATIC_FLOWER_IMAGES[monthIndex];

        // Logic to build the days array
        const getCalendarDays = (date) => {
          const y = date.getFullYear();
          const m = date.getMonth();
          const firstDayOfWeek = new Date(y, m, 1).getDay();
          const daysInMonth = new Date(y, m + 1, 0).getDate();
          const days = [];
          for (let i = 0; i < firstDayOfWeek; i++) days.push(null);
          for (let d = 1; d <= daysInMonth; d++) days.push({ date: d, isCurrentMonth: true });
          return days;
        };

        const days = getCalendarDays(currentDate);

        const handlePrev = useCallback(() => {
          setCurrentDate(prev => new Date(prev.getFullYear(), prev.getMonth() - 1, 1));
        }, []);

        const handleNext = useCallback(() => {
          setCurrentDate(prev => new Date(prev.getFullYear(), prev.getMonth() + 1, 1));
        }, []);

        const handleDateClick = async (day) => {
          setSelectedDay(day);
          
          const eventKey = `${(monthIndex + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
          const historicalEvent = HISTORICAL_EVENTS[eventKey] || null;
          setModalHistoricalEvent(historicalEvent);

          const dailyCacheKey = `${year}-${monthIndex}-${day}`;

          if (dailyCache[dailyCacheKey]) {
            setModalContent(dailyCache[dailyCacheKey]);
            setModalLoading('SUCCESS');
            return;
          }

          setModalLoading('LOADING');
          setModalContent(null);

          let promptContext = `A peaceful day on ${monthName} ${day}, ${year}`;
          let isHistorical = false;

          if (historicalEvent) {
             promptContext = `${historicalEvent.title}: ${historicalEvent.description}`;
             isHistorical = true;
          }

          const [image, quote] = await Promise.all([
            generateDateIllustration(promptContext, isHistorical),
            generatePeaceQuote()
          ]);

          const newContent = { image, quote };
          setDailyCache(prev => ({ ...prev, [dailyCacheKey]: newContent }));
          setModalContent(newContent);
          setModalLoading('SUCCESS');
        };

        const closeDateModal = () => {
          setSelectedDay(null);
          setModalContent(null);
          setModalHistoricalEvent(null);
        };

        const getFullSelectedDate = () => {
          if (!selectedDay) return new Date();
          return new Date(year, monthIndex, selectedDay);
        };

        return (
          <div className="min-h-screen bg-stone-50 py-10 px-4 flex flex-col items-center font-sans">
            <Calendar 
              monthName={monthName}
              year={year}
              days={days}
              imageUrl={currentMonthImage}
              onNext={handleNext}
              onPrev={handlePrev}
              onDateClick={handleDateClick}
            />

            <DateDetailsModal 
              isOpen={!!selectedDay}
              onClose={closeDateModal}
              date={getFullSelectedDate()}
              content={modalContent}
              historicalEvent={modalHistoricalEvent}
              loadingState={modalLoading}
            />

            <footer className="mt-8 text-stone-400 text-sm print:hidden text-center max-w-md">
              {!apiKey && (
                 <p className="text-red-400 mt-2">API Key missing. Daily details will not generate.</p>
              )}
            </footer>
          </div>
        );
      };

      // ==========================================
      // MOUNT
      // ==========================================
      const rootElement = document.getElementById('root');
      if (rootElement) {
        const root = ReactDOM.createRoot(rootElement);
        root.render(<App />);
      }
    </script>
  </body>
</html>